@*
    For more information on enabling MVC for empty projects, visit https://go.microsoft.com/fwlink/?LinkID=397860
*@
@model MVC_AUTOSALONI.Models.AddAutoViewModel


<h1>Inserimento nuova Auto</h1>



<form method="post">

	<div class="mt-3">
		<label class="form-label">Marca</label>
		<select asp-for="ID_Marca" asp-items="@ViewBag.MarcaDDL" class="form-select" onchange="OnMarcaSelezionata(this)">
			<option disabled selected>Selezionare una Marca</option>
		</select>
	</div>

	<div class="mt-3">
		<label class="form-label">Modello</label>
		<select id="ddlModello" asp-for="ID_Modello" asp-items="@ViewBag.ModelloDDL" class="form-select">
			<option disabled selected>Selezionare una Modello</option>
		</select>
	</div>

	<div class="mt-3">
		<label class="form-label">Auto</label>
		<input type="text" class="form-control" asp-for="targa" />
	</div>
	<br />

	@if (TempData["Errore"] is not null)
	{
		<div class="alert alert-danger">
			<strong>@TempData["Errore"]</strong>
		</div>
	}

	<div class="mt-3">
		<button type="submit" class="btn btn-primary">Salva</button>
	</div>

</form>



<script>
		function OnMarcaSelezionata(selectElement){
			const ddlModello = document.getElementById("ddlModello");
			var selectedvalue = selectElement.value;
					fetch(`/Auto/PopolaDDLModelli?ID_marca=${selectedvalue}`)
						.then(response => response.json())
						.then(data => {
							data.forEach(modello => {
								const riga = document.createElement("option");
								riga.value = modello.value;
								riga.text = modello.text;
								ddlModello.appendChild(riga);
							});
						})
						.catch(error => {
							console.error("Errore nel caricamento dei modelli:", error);
						});
		}
</script>

